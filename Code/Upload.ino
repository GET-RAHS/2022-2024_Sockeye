%%%%%%%%%#*=:....:-+#%%%%%%%%%%%%%%################################***+++++++========------============++++++++++============--::.........::-=+**#%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%#**+++++============----------:::::----===========================-::.:-+*#%%#*************############################################%%%%#####%%%%%%%%%%%%%%%%%%%%###**+=-:...:-=++**#####%%%%%%%%%%%%%%%%%%%%%%%#+-:...:-+#%%%%%%%%%%%%%%%%##########**######################********+++++++==+++++++++++++++++++++++++===========--:::.........::-=+*##%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%#*+++++============-------------------============================--:.:-+*%%%###**********#########################################%%%%%%%%#%%%%%%%%%%%%%%%%%%%%%%%##**+=-:...:-=++**######%%%%%%%%%%%%@@%%%%%%%%%#*=-:...:=*%%%%%%%%%%%%%%%%%%%#######********########################**********************+++++++++++++==========--::.....:::..:::-++*##%%%%@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%#*+++++=======++===-------------------=======================++++++=::.:-+*%%@%###***********###*###########################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=:....:-=+***########%%%%%%%%%%@@@@@%%%%%%%#*+-:...:-*#%%%%%%%%%%%%%%%%%%%%%#####**************######################*********************+++++++++==========--:......::::..::--=++*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%#**+++=======+++===-------------------==============================--:::-=+*#%%%###***********##########################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=-::..::-=+****#######%%%%%%%%%%%%%@@@%%%%%%%%#*=-...:-*#%%%%%%%%%%%%%%%%%%%%%%%#######******************###############********************++++++++++==========-:....::::::...:--==+**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@%##*+++======+++===-------------------=================================-::::-=+*#%%####********##########################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=-:...:--=+***#########%%%%%%%%%%%%%%@@%%%%%%%%#*+-:..:-+*#%%%%%%%%%%%%%%%%%%%%%%%%#########*******************#########********###**********+++++++++++======+==-:...::---::..::--==++**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%%#*+++======+++===-------------------===================================-::.::=+*#%%%%##******#########################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=-:....:-=++***###########%%%%%%%%%%%%%@%%%%%%%%%##+=:...:=+*%%%%%%%%%%%%%%%%%%%%%%%%%#%%#########*****************#######****########*********++++++++++++++++++==-:...:-=--::.::::-==+++**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%%##*++=====++++====------------------====================================---:::--=+**##################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*=-:....::-=+*****###########%%%%%%%%%%%%@@%%%%%%%%%%#*=-:..:-=*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#############****########################**********+++++++++++++++++==-::..:-===--:.::::--==+++*##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%%%#*+++====++++=====-----------------======================================--:::::--=+**###############################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##**+=::...::-==+******##########%%%%%%%%%%%%%%%%%%%%%%%%%%#+=-:..:-+#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##################################**************++++++++++++++++=-::..::-===--:::::::--==++**#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%%%%%#*++++====++++========-------------=========================================--:::.:::-=++**######################################%%%%%%%%%%%%%%%%##%%###*+=-::...::-==++******###########%%%%%%%%%%%%%%%%%%%%%%%%%%#*+-:...:=*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#################################************++++++++++++++++=::..::-====--::::::::---==+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%
    @@@@@@@%%%#*++++======+++========----:::-----=====================================--------:::::::::---==++**#################################################***+==-::...::-==++*******###########%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+-:..:-+*#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###%%%%#############################********+++++++++++++++=-:...:-=====--::::::::::--=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%
    @@@@@%@%%%%#*+++==================---:::-----====================================-----------::::.....:::--==+++***********#########################*******+++==--::....::--=++*********##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*=::..:=+*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%%%%%%%%%%########################********+++++++++++++==-...::==++==--::::::::::--=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%
    @@@@@@@%%%%#**++++=================---:::----=======================================-----------::::::.......::::---====++++***********************++++++==--:::......::-==++**********#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+-::..:-+##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%%%%%%%%%%%%%%%%##################*********++++++++++++=-:..::-=++++=---:::::::::--=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%
    @@@@@@%%%%%%#*+++++=================---::----=============================================---------:::::::.......:::::::::---------==============------::::......::--==++*********##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+-:...:=*##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###############********++++++++++=-::..:-==++++==----:::::----=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%
    @@@@@%%%%%%%%#*++++++===============----------======================================================-------:::::::...............::::::::::::::::::::.....:::::---==++****################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+-:..:-=+#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##############*******++++++++++=:...:-=++++++===----------===*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@%%%%##*++++++==============-----------===========================++++++++++++++++++++++++++++++++======-----:::::::::::::...........:::::::::::---===++++***####################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####*=-:...:=+##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%############*******++++++*++=-:..::=+++++++==============++*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@%%%%%%##*+++++==============--------------===================+++++++++++++++++++++************************+++++++============------========+++++++++******###################%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%%%%%%%%%###**+-:...:-=+###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##########**************+=-:..:-==++++++++===========+++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@%%%%%%%%#++++================-------------==================++++++++++++++++************##########################**************************************################%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@%%%%%%%%%%%%%####*+-::..::-+**####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##########**************+-::.:-==+++++++++++====+++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@%%%%%%%%##*+=================------------==================++++++++++++++++*********#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####***********################%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%####*+=-:...::-+**####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#########************++=:..::-+++++++++++++++++++++****##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@%%%%%%%%%#*++=======+=======-----------===================++++++++++++++**********#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*****++++++***###############%%%%%##%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%####*+=-:...::-=+**########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##########********##*+-::.:-=++++++++++++++++++++******##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@%%%%%%%%%%%#*++===============---------=====================+++++++++++***********##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####**++++++++++****############%%%###########%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%##*+=-:...::-=++***###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%#########**#####**+-::::-=++*++++++++++++++++*******###%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@%%%@@%%%%@@%%%%%%#*++==============---------=====================+++++++++++**********###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###***+++=======+++****###########%%%############%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%#*+=-:....::-==++****#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##############*=::.:-==+****++++++++++**********####%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@%%%%@%%%%%%%##*+============---------=====================+++++++++++***********#############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###***+++=====-====+++*****##########################%%%%%%@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%##*+=-::...:::--==+++***###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####%%%%%#+=-::::-=++******++++++++*********######%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@%%@@@%%%%%%%#**++========----------====================++++++++++++***********##############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####***+++=====-----===+++++********#########*******######%%%%%%%%%@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%#*++=-::::...:::---===++++*****######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###*+=-::::-=++********++++++++*******#######%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@@@%%%##+====---------------==--===============++++++++++++************###############%%%%%%%%%%%%%%%%%%%%%%%%%######***++++====-------=====+++++++++********************######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##**++=--::.........:::--===++++**#########%%%%%%%%%%%%%%%%%%%%%%%%%###*+=-::..:-=+************++++++***############%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@@@@@%%@%%%%#*+==--------------=====================++++++++++++************##################%%%%%%%%%%%%%%%%%%#######******+++++===--------=====================+++++++++*****######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####****+++==--:::........:::::::--====+++++****##****##********+++==---:::.:--=++*************++++++***###########%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    @@@@@@@@@@@@@@@@%%%%%%@@@%%%##*+++++++++===---=====================++++++++++++++***********###################%%%%%%%%%%%%%%#########*********++++==---:------------------::::-----=====++++****##########%%%%%%%%#############%%%%%%%%%%%%%%%%#########****+++==---:::::........:::::--------=============-------:::::::--==++**************+++++++**############%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%
    @@@@@@@@@@@@@@@@%%%%@@@@@@@%%%%%%%%%%%##*+==---====================++++++++++++++++**********#########################%%%#################*******+++==--::::---------:::...........::---====+++******#############################%%%%%%%%%%%%#######*######%%####**++===---:::::...................................:::-==++******************++++++***############%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%
    @@@@@@@@@@@@@@@@%%%%@@@@@@@@%%%%%%%%%%%#*+===-=====================++++++++++++++++***********###############################################*****+++==--::::::::-:::::..............:::--====++++++********#######************########%%%%%%#######*****####%%%%%%%#####***++===-----::::::::::::::::::::::::::::----==+++***************************############%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%
    %%%%%@@@@@@@@@@@%%%%@@@@@@@@@@@@@%%%%%%%*+===-====================++++++++++++++++*************################################################****+++==--::::::::::::::...............:::---=====++++++*************++++++++++*****##############*********####%%%%%%%%%%%%####*****++++=======---------------------===++++***************************############%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%
    %%%%%%%@@@@@@@@@%%%%@@@@@@@@@@@@@@@%%%%#*+===-====================+++++++++++++++++*************#################################################***+++===---:::::::::::::::::::::::....::::--=========++++++++++++++============++++*****######*****+*******####%%%%%%%%%%%%%%%%%%%%#####******+++++++==============++++****************************#############%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%#*+========================+++++++++++++++++++**************##############################################*****+++===------:::::::::::::::::::::::::::-------========++++=====---:::::::::---===++++*******+++++++++****####%%%%%%%%%%@@@%%%%%%%%%%%%#########*******++++++++++++*************************##**############%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%#*+===--====================+++++++++++++++++++****************##########################%%%%%%%%##########*****+++======----------------::::::::::::::------------=======----::::.........:::--====+++++++++++++++++++***####%%%%%%%%%@@@@@@@@%%%%%%%%%%%%%%%#######************************************#################%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%@@@%%%@@@@@@@@@@@@@@@@@@@@%%%#*+===---====================+++++++++++++++++++******************#######################%%%%%%%%%%########******++++++==========-------------:::::::::::------------------:::::::............::---===========+++++++++++***###%%%%%%%%%%%%%%%@@%%%%%%%%%%%%%%%%%%#######********************************#################%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@%%%%%%%%%%#*+==========================+++++++++++++++++++++***************########################%%%%%%%%%#########********+++++++++++===========---------:::::::::::::---------::::::::::::::::.....::::-----=======+++++++++++++***####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#########****************************################%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@%%%%%%%%%#*+==========================+++++++++++++++++++++***************########################%%%%%%%###########**************+++++++++++===========------:::::::::::::::::---------------:::::::::::::-----===+++**********+++****####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%############************************###########***###%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%#*+==========================++++++++++++++++++++++***************#########################################*******************+++++++++++=========------::::::::::::--------======-------::::::::::---==++****######***********####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##############**********************###########****##%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@%%%%%%#*+=========================+++++++++++++++++++++++*******************######################################************************+++++++++++=======----------------================-------------===++**############**********######%%%%%%%%%%%%%%%%%%%%%%%%%%%################********************##########*******##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@%%%%%%%%#*+=========================++++++++++++++++++++++++*******************####################################################*************++++++++++========-------=======++++++++++++===============+++**######%%%%%######********######%%%%%%%%%%%%%%%%%%%%%%%%##################*******************##########*******##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%%%#*++==--====================++++++++++++++++++++**********************#############################################################************+++++++===============++++++++++++++++++++++++++++++****####%%%%%%%%%%######*****#########%%%%%%%%%%%%%%%%%%%%###################********************#######********####%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%@@@@@@@@@@@@@@@@@@@%%%%%%%%%#**+===---==================++++++++++++++++++++**********************###############################################################**************+++++++++=====++++++*****************+****++******#####%%%%%%%%%%%%%#######**##########%%%%%%%%%%%%%%%%%%%#################*****************+***###############*###%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%%%%%#*+======-================++++++++++++++++++++***********************####################**####***###############################################*****+++++++++++++*******************************######%%%%%%%%%%%%%%%####################%%%%############################***********++**++++****#################%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%%%%%#*+==--==--===============++++++++++++++++++++*********************####################**************################################################******************#################################%%%%%%%%%%%%%%%##################################################**********++++++++++****#################%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%%%%%%%#*+==----================+++++++++++++++++++++**********************###################****************#################################################################################################%%%%%%%%%%%%%%%################################################***********+++++++++++****#######*****####%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%@%%%%%%#*+==-----================+++++++++++++++++++************************############***********************################****************######################%%%%%%%%%%%%###############################%%%%%%%%%%%%%%###############################################***********++++++++++++***#####*******###%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%@@@@@@@@%%%%@%%%%%%%#*+==-----================++++++++++++++++++**************************##########***********++***********************************************#################%%%%%%%%%%%%%%%######################%#####%%%%%%%%%%##################################################**********++++++++++++++**#####*******###%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%@@%%%@@%%%%%%%%#*+==-----=================+++++++++++++++++************************#######*************+++++++**********************++*************************#############################%%%%%###########%%%%%%%%##%%%%%%%%%############################################******************+++++++++++++***####*******##%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%@@%%@@@%%%%%%%%#*+==-------===============++++++++++++++++************************######************+++++++++++++++++++++++++++++++++++++++**********************###############################################%%%%%%%%%%%%%#######################*****###############*****************+++++++++++++++++*************##%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@%%%%%#*+==--------=============++++++++++++++++++***********************####*************++++++++++++++++============+++++++++++++++++*************************###########*****##########################%%%%%###########################************************************+++++++++++++++++++************##%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%#*++=---------=============++++++++++++++++++**********************####************+++++++====================================+++++++++++++++++**************************#############################################################****************************+++++++++++++++++++++++++++++++***##%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@%%%%%%#**+=---------=============+++++++++++++++++++*************************************+++=========------------=====--====-----=============+++++++++++++++++**********************#####################################******#############*************************+++++++++++++++++++++++++*******###%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=----------=============++++++++++++++++++************************************+++====-------------------------------------------===========+++++++++++++******************************########################**********###########************************++++++++++++++++++++++++****####%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@%%%%%##*+=-----------============++++++++++++++++++***************************###******++===------:::::::::::::--------::---------------------============+++++++++++++++***++++++++******************##############********++****########*************************++++++++++++++++++++++++**#%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@%%%%%%%##*+=------------============+++++++++++++++++************************#######****++===-----:::::::::::::::::::::::::::::------------------------===============+====+==========+++++++++**************########*******+++++*****#####**********************+++++++++++++++++++++++++++**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@%%%
    %%%%%%%%%%%%%%%%%@@@@@@@@@@%%%@@%%%%%%%%#**+==------------============++++++++++++++++************######****#########****++==----:::::::.:::::::::::::--------:--========-----------------------------======-----==============++++++++++++*******##********+++++++*****#####********************++++++++++++++++++++++++++++*##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@%%%
    %%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%%%%%%%%%#**+==-------------=============++++++++++++++************###****#*#########****++===---::::.......:::::::::--========-==+++++++++====+++++========--------------------------------------=====+++++++++************+++++++++*****####*******************++++++++++++++++++++++++++++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@%%%
    %%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@%%%%%%%%##*+==--------------=============+++++++++++++*************#################***++++====--:::......::::::::---===+++++++++*****#****++***###*******+++==================------=------:--------==========+++++******+++++++++++****************************+++++++++++++++++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@%%%
    %%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@%%%%%%%##*+=----------------==============+++++++++++++***********################*****+++++====--::.....::-------===+++++******##############%%%%%%%%%%%##**+++******#******++====+++===--::-------------========+++++++++++++++++++****************************++++++++++++++++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@%%
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@%%%%%%%#**+=-----------------==============+++++++++++++++********#################*****+++++++++=--:::.::-------===+++********###%%%%%%%%%%%%%@@@@@@@@@@@%%#**#%%%@@@@@@%%%##*********++==----------------------======++++++====++++****************************++++++++++++++++++++++++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%#**+=------------------===============++++++++++++++********################**************++=--:..:-------===++********####%%%%%%%%%%%@@@@@@@@@@@@@@%%##%%@@@@@@@@@@@%%%#########**+======-----:::------------======++====++++******##********************+++++++++++++++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%#*++=------------------=================++++++++++++*********################***************++=-::----=----==+*********##%%%%%%%%%%%%@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@@%%%%%%%%%###**+++++===--:::::::::::::-----====+===++++******####*******************+++++++++++++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@%%%%%%%#*++=-------------------=================+++++++++++**********####################*******###**++==----=-----=+*********##%%%%%%%%%%%%@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@%%@@%%%%%####****++==--::::::::::::::::---=====++++*******#####********************++++++++++++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%#*+==--------------------==================+++++++++***********#####################*******#****+++===---:---=+++++====+*#######**#%%%@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@%%%%%%#####****+==----::.......:::::---====+++*******##########***************++++++++++++++++++++*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@%%%%%#*+==---------------------==================+++++++++**********######################*************+++===-----===+=======+********+*##%%%%%%%%@@@@@@%%%%%%@@@@@@@@@@@@@@@@%%%%%%%%%%#######**++===---::........:::---====++****##############***************++++++++++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%##*+==-----------------------=================+++++++++********########################*****************++=============+++************####%%%%%%%%%%%%%%%%%@@@@@@@@@@@@%%%%%%%%%%%%#########**++===--::........:::--=====++****#############******************+++*+++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@%%%%%%#*+=-------------------------================+++++++++++********########################****************+++++++++++++++***#####******###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%############*++++==--:::....::---=======++++***#############***********************+++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@%%%%%%%%%#*+=--------------------------===================+++++++*********########################**************************+++****######***#########*###%%%%%%%%%%%%%%%%%%%%%%%@@@@%%%%########*****+====--:::::::--===++++++=++++****###########***+++*******************++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%@@@@@@@@@@@@@@@@@%%%%%%%%%%#++=----------------------------==================+++++++***************########%%#########********************************#####**####%%%%#####%%%@@@%%%%%%%%%%%%%%%%%%@@@@@@%%%%%%%##*****+====-:::::::--=++*****++++++++***############**+=-=+*****************+++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%%%*+==----------------------------===================++++++****************########%%%#######**************************************#######%%#####%%%@@@%%%%%%%%@@@@@%%%%@@@@@@@@%%%%%%%%####**++==--:::--==++********++++++****###########***++==+****************+++++++++++**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@%%%%%#*+=-------------------------------==================+++++*****************#########%#######******************************################%#####%%%%@%%%%%%%%@@@@@@%%%%@@@@@@@@@%%@@%%%%#####**++==-===++***####******+******###########*****+++*******+********+++++++++++**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@%%%%#*+=---------------------------------================+++++**********#*********##############******************************#####################%%%%%%%%%##%%%%@@@%%%%%%%@@@@@@%%%%@@%%%%%#####**+++++*****######***********##############**************+******+++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%#*+=----------------------------------===-===========+++++*******####***********#############******************************#######%%%%%%%%%%%%%%%%%%%%%####%%%%%%%%%##%%%%%%%%%%%%%%%####****************#######***#####################**********************++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%#*+=--------------------------------------============++++*******####************############**********************+*********#######%%%%%%%%%%%%%%%%%%%####%%%%%%#####################******************################################*********************++++++++++++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@%%%%%%#*==--------------------------------------============+++++*****######*****++++****###########**********************++*********##########%%%%%%%%%%%%%%%%%%%%%%%%#%#################********************################################*************++****+++++++++++++*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%@@@%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%#*=------------------------------------------===========+++*****########****++++****##########***********************+************##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###############*************################%################***********++++++++++++++++++++++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%##+=-------------------------------------------==-=======++++****##########***++++***###########**##******************+**************##############%%%%%%%%%%%%%%%%%%%%%%%%%###############************##############%%%%%############************+++++++++++++++++++++**#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@%%%%%%#*+=-----------------------------------------------======++++****###########***++++***###########*###***********************************#######################%%%%%%%%%%%################*************############%%%%%%%##########*************++++++++++++++++++++++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%@@@@@%%%%@@@@@@@@@%%%%%%#*+=-----------------------------------------------=======+++****############**********##########**************************+++***********################################################*************###########%%%%%%%%############*********++++++++++++++++++++++++*#%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%%#*+=------------------------------------------------======++++***######%%%%####*********##########***************************++++**************#####################################******************##########%%%%%%%%%###########********++++++++++++++++++++++=++*#%%%%@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%#*+=-------------------------------------------------=====++++***######%%%%#####********############************#######********+++++++++++**********###########################**********************##########%%%%%%%%%###########********++++++++++++++++++++++==+*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@%%%%%%#*+---------------:::---------------------------------=====++++***######%%%%#####********############************##########*********+++++++++++++************###############***********************############%%%%%%%%%########*********+++++++++++++++++++++===++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@%%%%%%*+=-----------:::::::::::::::------::-------------------====++++***#######%#######********#############*********################********+++++++++++++**********************************************###########%%%%%%%%%#########*******+++++++++++++++++++++====++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%#*+=-----------:::::::::::::::::::::::::-----------------=====+++*****##############*******###############*******####################********+++++++++++++++++++**********************************#############%%%%%%%##########*******++++++++++++++++++++=====++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%@@@@@@%%%%%%%%#*+=------------::::::::::::::::::::::::::----------------====++++****###############*******################***###########################**********+++++*************************************#################%%%%%%###########******++++++++++++++++++++=====++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=------------::::::::::::::::::::::::::::---------------====+++****################*****##################################################****************************#######################################%###############*****+++++++++++++++++++======++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@%%%%%%#*==-------------::::::::::::::::::::::::::::---------------====+++****#################**##################################*####################************##################################################################*****++++++++++++++++++=======++*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%%%%%%#+=-----------------:::::::::::::::::::::::::::--------------====+++*****##################*############################################################***####################################################################*****++++++++++++++++========+**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@%%%%%%*+=-----------------::::::::::::::::::::::::::::--------------====+++*******##################################################################################################################################################*****+++++++++++++++========++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%@@%%%%%%%%%%%%%%%#*+=------------------:::::::::::::::::::::::::::::::------------===++++******###################################################################%%%%%%######################################################################******+++++++++++++==========++*##%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*=--------------------:::::::::::::::::::::::::::::::::----------====+++******##############################################%#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###########################################################*****+++++++++++++==========++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%@@@@
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=---------------------::::::::::::::::::::::::::::::::::---------====+++******########################%%%%%%%###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##########################################################******++++++++++============+**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=----------------------:::::::::::::::::::::::::::::::::::---------===++++******########################%%%%%%%########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####################################################******++++++++++===========++*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%@@@@%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+=------------------------:::::::::::::::::::::::::::::::::::::-------====+++******#########################%%%%%%%#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#%%%%###%%%%%%###############################******+++++++=============+**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%@@@@@%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=-------------------------::::::::::::::::::::::::::::::::::::::-------===++++******######################%%%%%%%%%##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%########################*****++++++=============++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%####%%%%%%%%%%#*==--------------------------:::::::::::::::::::::::::::::::::::::::------====++++*******###################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%######################*****++++++=============+**#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%##**+++++***##%%%##+=-----------------------------::::::::::::::::::::::::::::::::::::::::-----===++++++******#**##############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#####################*****++++++============++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%#**+==-------===+++++==------------------------------:::::::::::::::::::::::::::::::::::::::::-----===++++++***********############%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##################*****+++++=============+*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%##++=---::::::::::---==---------------------------------::::::::::::::::::::::::::::::::::::::::::----====++++++*************##########%%%%%%%%%%%%######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##################*****++++=============++*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%#*+=--:::::::::......:::----------------------------------:::::::::::::::::::::::::::::::::::::::::::----=====++++++************###############%%%%###########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###################*****++++============++*#%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%#*+=-::::::::::.......:::-----------------------------------:::::::::::::::::::::::::::::::::::::::::::-----=====+++++++++++*******#################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##################****++++============++*##%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%
    %%%%%%%%%#*+---::::::::::.......:::-------------------------------------::::::::::::::::::::::::::::::::::::::::::::----======+++++++++++*****#########################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#################****++++============+*##%%%%@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@%%%%%%@@@@@@@@@%%%%%@@@@@%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%
    %%%%%%%%#*+=-::::::::::::......::::-------------===----------------------::::::::::::::::::::::::::::::::::::::::::::------=======+++++++++*****####################################################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###############*****++=============+*#%%%%@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@%%%%%%%@@@@@@@@%%%%@@@@@@%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%
    %%%%%%%#*+=--:::::::::::::....:::::----------==========--------------------:::::::::::::::::::::::::::::::::::::::::::::------===========++++******#######*****#########**############################%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%################*****+++======-====++*##%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%@@@@@@@%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%
    %%%%%%#*+=--::::::::::::::::.::::::----------=============------------------::::::::::::::::::::::::::::::::::::::::::::::-------===========++++******####*******###**************************#############%%%%%%%%%%%%%%%%%%%%%%%################*****++++=====--===++*##%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%@@%%%%%%%%%%%%%%%%%%%%@@@@@@@%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%
    %%%%%#*+=-:::::::::::::::::::::::::---------===============------------------:::::::::::::::::::::::::::::::::::::::::::::::::---------========+++++****####*************************************############%%%%%%%%%%####%%%%#################*****++++====----==+**#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%%%%%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%
    %%%%#*+=--:::::::::::::::::::::::::--------===================-----------------:::::::::::::::::::::::::::::::::::::::::::::::::-------------====+++++***************************+++++++++++++*****#####################################***********++++====-----=+**#%%%%%@@@@@@@@@@@@@@@@%%@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@%%%%%%%%@@@@@@@@@@@@@@%%@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%#*+=--:::::::::::::::::::::::::::-------=======================---------------::::::::::::::::::..::::::::::::::::::::::::::::::------------=====++++++*********++++++++***+++++++++====+++++****##############################***************++++====-----==+*#%%%%%@@@@@@@@@@@@@@@@@%%%%@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@%%%%%%%%@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%#*+=--::::::::::::::::::::::::::::------=========================---------------::::::::::::::...........::::::::::::::::::::::::::::-----------======++++++++++++++++++++++++++++++++====+++++****######################******************+++++====--------+**#%%@@@@@@@@@@@@@@@@@@@@@%%%%@@@@%%%%%%%%%%%%%%%%%%%%%@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@%%%%%%%%%%%%@%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ##*=---:::::::::::::::::::::::::::::------==========================---------------:::::::::::::...............::::::::::::::::::::::::::::::---------=====++++++++++++++++++++++++++++++++==++++++**************************************++++++=====---------=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@%%%%@@@%%%%%%%%%%@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%
    *+==--::::::::::::::::::::::::::::::------============================---------------:::::::::::::................:::::::::::::::::::::::::::::::--------===============+++++++++++++++++++++++++++++++++++****************+++++++++++++++++=====-----------==*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    +=----::::::::::::::::::::::::::::::------==============================--------------::::::::::::::.................::::::::::::::::::::::::::::::::-------=============+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++=====--------------=++#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    =-----------::::::::::::::::::::::::------=================================-------------:::::::::::::.......................:::::::::::::::::::::::::::::------============+++++++++++++++++++++++++========+++++========================------------------=+##%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    --------------::::::::::::::::::::::-----====================================-------------::::::::::::.......................:::::::::::::::::::::::::::::::-------=============+++===+++++==========================================---------------------=+*%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ---------------::::::::::::::::::::------======================================-------------::::::::::::........................::::::::::::::::::::::::::::::::------------==========================-----------------------------------------:::-------=+*#%@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@%%%%%%%%%%%%%
    --------------:::::::::::::::::::::-------=======================================------------::::::::::::.............................::::::::::::::::::::::::::::::::::---------------------------------------------------------------:::::::::--------=+*#%@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@%%%%%%%%%%%%%
    ------------:::::::::::::::::::::::-------===============++++======================-----------::::::::::::.................................:::::::::::::::::::::::::::::::::::----------------------:::::::::::::::::-------::::::::::::::::::---------==*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ---------::::::::::::::::::::::::::------===============+++++++======================------------:::::::::::.................................:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::----------==+*%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ------:::::::::::::::::::::::::::::------================++++++++======================-----------:::::::::::::.....................................::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::------------=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ------:::::::::::::::::::::::::::::------===========++++++++++++++++=====================----------::::::::::::::.....................................:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::------------=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    -----::::::::::::::::::::::::::::::::----==========++++++++++++++++++++++==================---------:::::::::::::::.......................................::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::------------==*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    -::::::::::::::::::::::::::::::::::::----=========++++++++++++++++++++++++==================----------::::::::::::::::................................................:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--------------==+*%%%@@@@@@@@@@@@@%%@@@@@@@@@@@@%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    -::---::::::::::::::::::::::::::::::::---======+++++++++++++++++++++++++++====================----------:::::::::::::::::.......................................................::::::::::::::::::::::::::::::::::::::::::::::::::-----------------=+*#%%%@@@@@@@@@@@@@%%@@@@@@@@@@@@%%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ----------:::::::::::::::::::::::::::::---====++++++++++++++++++++++++++++++====================----------::::::::::::::::.........................................................................::::::::::::::::::::::::::::-------------------=+*#%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    -----------::::::::::::::::::::::::::::----===+++++++++++++++++++++++++++++++=====+==============-----------::::::::::::::::::...................................................................::::::::::::::::::::::::::::--------------------==+#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    ---------------::::::::::::::::::::::::-----===+++++++++++++++++++++++++++++++++=+++++============------------::::::::::::::::::::..............................................................:::::::::::::::::::::::::-----------------------==+*#%%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        Guillermo made this thingy 
                                                                                                            
*/

    WirelessInit();
    Log(&Serial,0,"Ethernet","starting");
    pinMode(hall_pulse_pin,INPUT);

    pinMode(mtr_temp_pin,INPUT);
    pinMode(mtr_fan_temp_pin,INPUT);

    // GPS
    GPSInit();
    Serial << gps->fix.dateTime; Serial.println();

    // SD Card
    SDCardInit();

    odometer_read();

    // I2C
    Wire.begin();
    Wire1.begin();

    // DPS
    // pinMode(25, INPUT_PULLUP); // for DPS310 sensor / pressure sensor
    DPSInit();

    // INA226
    INAInit();

    // BMS
    BMSInit();

    // MPPT
    MPPTInit();

    //Data Sending
    Wire.setSCL(19);
    Wire.setSDA(18);

    Serial.println("\n\n\n");
    Serial.println("Starting...");
    Serial.println("\n\n\n");
    delay(1000);
}

unsigned long Now = millis();
unsigned long Last = Now;

//DATA RECEIVING--------------------------------------------------------------------------------------
unsigned int numbytes = 0;

//expected size (in byes) of values recieved
const unsigned int PedVSize=4,
CCVSize=4,
StatusesSize=1,
BrakeInSize=4,
KPHSize=4,
TripDistanceSize=4,
tokenSize = 1,
expectedTransmitSize = PedVSize + CCVSize + BrakeInSize + KPHSize + TripDistanceSize + StatusesSize + tokenSize;

unsigned char SecondaryTeensyData[expectedTransmitSize]={0};

//default set values recieved
float PedV=0.0,
CCV=0.0,
BrakeIn=0.0,
KPH=0.0;

uint8_t Statuses = 0b00000000;
uint8_t token = 0b00000000;

float float32min=1.17549435082e-38;
float float32max=3.40282346639e+38;

unsigned long LARSEN___________a___frbinexpwithbias(float x, int* exp)
{
    unsigned long bin=0;
    unsigned int i=0;
    float normalized=x;

    if (x==0.0 || float32min>x) { // 0.0 or less than min
        return 0;
    } else if (float32max<x) { // larger than max (inf)
        *exp=0b11111111;
        return 0;
    }
    if (x>=2.0)
    {
        while (normalized>=2.0) // normalize
        {
            normalized/=2;
            (*exp)++;
        }
    } else if (x<1.0) {
        while (normalized<1.0) // normalize
        {
            normalized*=2;
            (*exp)--;
        }
    } else if (x==1.0) { // weird
        *exp=127;
        return 0;
    }

    float temp=normalized;
    while (true)
    {
        temp*=2;
        if (temp>1.0)
        {
            bin|=1<<(22-i);
            temp-=1.0;
        }
        i++;
        if (temp==1.0 || i==23)
        {
            break;
        }
    }
    (*exp)+=127;
    return bin;
}


// SEND CODE

float frabs(float x)
{
    return x>0?x:-x;
}

void sendFloat32(float x)
{
    unsigned int signBIT=0;
    if (0.0>x)
    {
        signBIT=1;
    }
    int exp=0;
    unsigned long frbin=LARSEN___________a___frbinexpwithbias(frabs(x),&exp);
    unsigned long bits=signBIT<<31 | (exp&0xFF) << 23 | frbin&0b11111111111111111111111;
    Wire.write((unsigned char)bits&0xFF);
    Wire.write((unsigned char)bits>>8&0xFF);
    Wire.write((unsigned char)bits>>16&0xFF);
    Wire.write((unsigned char)bits>>24&0xFF);
}
void sendUInt8(unsigned long x)
{
    Wire.write((unsigned char)(x&0xFF));
}

void sendUInt16(unsigned long x)
{
    Wire.write((unsigned char)x&0xFF);
    Wire.write((unsigned char)x>>8&0xFF);
}

void sendUInt32(unsigned long x)
{
    Wire.write((unsigned char)x&0xFF);
    Wire.write((unsigned char)x>>8&0xFF);
    Wire.write((unsigned char)x>>16&0xFF);
    Wire.write((unsigned char)x>>24&0xFF);
}
void sendInt8(int x)
{
    unsigned int mag=abs(x)&0x7F;
    unsigned int int8bin=mag;
    unsigned int sign=0;
    if (0>x){
        sign=1;
        int8bin=~mag+1|sign<<7; // check precedence
    }
    Wire.write((unsigned char)int8bin&0xFF);
}

void sendInt16(int x)
{
    unsigned int mag=abs(x)&0x7FFF;
    unsigned int int16bin=mag;
    unsigned int sign=0;
    if (0>x){
        sign=1;
        int16bin=~mag+1|sign<<15;
    }
    Wire.write((unsigned char)int16bin&0xFF);
    Wire.write((unsigned char)int16bin>>8&0xFF);
}

void sendInt32(long x)
{
    unsigned long mag=abs(x)&0x7FFFFFFF;
    unsigned long int32bin=mag;
    unsigned int sign=0;
    if (0>x){
        sign=1;
        int32bin=~mag+1|sign<<31;
    }
    Wire.write((unsigned char)int32bin&0xFF);
    Wire.write((unsigned char)int32bin>>8&0xFF);
    Wire.write((unsigned char)int32bin>>16&0xFF);
    Wire.write((unsigned char)int32bin>>24&0xFF);
}
// SEND CODE 

unsigned int readUInt8(unsigned char** pData)
{
    unsigned char* data=*pData;
    *pData+=1;
    return (unsigned int)data[0];
}

unsigned int readUInt16(unsigned char** pData)
{
    unsigned char* data=*pData;
    *pData+=2;
    return (unsigned int)data[0]+((unsigned int)data[1]<<8);
}

unsigned long readUInt32(unsigned char** pData)
{
    unsigned char* data=*pData;
    *pData+=4;
    return (unsigned long)data[0]+((unsigned long)data[1]<<8)+((unsigned long)data[2]<<16)+((unsigned long)data[3]<<24);
}

int readInt8(unsigned char** pData)
{
    unsigned char* data=*pData;

    unsigned long bin=(unsigned long)data[0];
    int sign=(bin>>7)&1;
    unsigned int mag=bin;
    *pData+=1;
    if (sign==1)
    {
        mag=~((bin&0x7F)-1);
        return -(int)mag; // check precedent
    }
    return (int)mag;
}

int readInt16(unsigned char** pData)
{
    unsigned char* data=*pData;
    unsigned long bin=(unsigned long)data[0]+((unsigned long)data[1]<<8);
    int sign=(bin>>15)&1;
    unsigned int mag=bin;
    *pData+=2;
    if (sign==1)
    {
        mag=~((bin&0x7FFF)-1);
        return -(int)mag; // check precedence
    }
    return (int)mag;
}

long readInt32(unsigned char** pData)
{
    unsigned char* data=*pData;
    unsigned long bin =(unsigned long)data[0]+((unsigned long)data[1]<<8)+((unsigned long)data[2]<<16)+((unsigned long)data[3]<<24);
    int sign=(bin>>31)&1;
    unsigned long mag=bin;
    *pData+=4;
    if (sign==1)
    {
        mag=~((bin&0x7FFFFFFF)-1);
        return -(long)mag; // check precedence
    }
    return (long)mag;
}

unsigned long readBitFlag8(unsigned char** pData)
{
    unsigned char* data=*pData;
    *pData+=1;
    return (unsigned char)data[0];
}

float decodeMantissa23(unsigned long bits)
{
    float sum=0.0;
    for (int i=0;i<23;i++)
    {
        bool flipped=bits>>((23-1)-i)&1;
        if (flipped)
        {
            sum+=1/pow(2,i+1);
        }
    }
    return sum+1.0; // Magical 1
}

float readFloat32(unsigned char** pData)
{
    unsigned char* data=*pData;
    int sign=1;
    float n=0.00;
    unsigned long float32bin=(unsigned long)data[0]+((unsigned long)data[1]<<8)+((unsigned long)data[2]<<16)+((unsigned long)data[3]<<24);
    Serial.printf("\nbits: %lx\n",float32bin);
    bool IsNegative = float32bin >> 31 & 1;
    if (IsNegative)
    {
        sign=-1;
    }
    int exp = (float32bin>>23 & 0xFF) - 127;
    unsigned long mantissaBits = (float32bin & 0b11111111111111111111111);
    float mantissa=decodeMantissa23(mantissaBits);
    Serial.printf("pow: %f\n",pow(2, exp));
    n = sign*mantissa*(pow(2, exp));
    *pData+=4;
    Serial.printf("Float: %f",n);
    return n;
}

float raw_readFloat32(unsigned long float32bin)
{
    int sign=1;
    float n=0.00;
    Serial.printf("\nbits: %lx\n",float32bin);
    bool IsNegative = float32bin >> 31 & 1;
    if (IsNegative)
    {
        sign=-1;
    }
    int exp = (float32bin>>23 & 0xFF) - 127;
    unsigned long mantissaBits = (float32bin & 0b11111111111111111111111);
    float mantissa=decodeMantissa23(mantissaBits);
    Serial.printf("pow: %f\n",pow(2, exp));
    n = sign*mantissa*(pow(2, exp));
    Serial.printf("Float: %f",n);
    return n;
}
    
void DecipherData(unsigned char* data)
{
    //recv order: pedv -> ccv -> statuses (byte) -> anBrakeIn -> kph -> tripDistance
    
    unsigned char* pData=data;

    // Serial.print("Real token");Serial.println(data[21]);
    
    PedV = readFloat32(&pData);
    Serial.printf("PedV: %f", PedV);
    // CCV = readFloat32(&pData);
    
    // BrakeIn = readFloat32(&pData);    
    // KPH = readFloat32(&pData);
    
    // Statuses = readBitFlag8(&pData); //check this
    // BrakeOn=Statuses>>7&1,CCOn=Statuses>>6&1; //statuses being sent through; add more as more statuses are added
    // pData+=StatusesSize;
    
    // TripDistance = readUInt32(&pData);

    // token = readUInt8(&pData);
    // Serial.print("Token");Serial.println(token);
}


void RequestData(unsigned char* data) {
    if (Wire1.available())
    {
        Serial.println("I2C buffer not empty");
        while (Wire1.available())
        {
            Wire1.read();
        }
    }
    Wire1.requestFrom(0x01, 4);
    numbytes=0;
    memset(data,0,sizeof data);
    // if (Wire1.available()) {
    //     Serial.println("data recieved");
    // } else {
    //     Serial.println("recieve error");
    // }

    while (Wire1.available()) {
      data[numbytes] = Wire1.read();
        Serial.printf("HELLO%x\n",data[numbytes]);
        numbytes++;
    }
    Serial.printf("\nnumbytes:%d\n",numbytes);

    if (numbytes != expectedTransmitSize) {
        Serial.println("Transmission error; expected bytes does not match recieved bytes.");
        Serial.print(numbytes);Serial.println(" recieved bytes.");
        Serial.print(expectedTransmitSize);Serial.println(" expected bytes.");
    }
}

// void RequestData(unsigned char* data) {
//     if (Serial5.available())
//     {
//         while (Serial5.available())
//         {
//             Serial5.readBytes(data,Serial5.available());
//         }
//     }
//     // Wire.requestFrom(0x01, 4);
//     numbytes=0;
//     memset(data,0,sizeof data);
//     // if (Wire.available()) {
//     //     Serial.println("data recieved");
//     // } else {
//     //     Serial.println("recieve error");
//     // }

//     Serial.printf("Available: %d",Serial5.available());
//     if (Serial5.available()) {
//         Serial5.readBytes(data,expectedTransmitSize);
//         Serial.printf("HELLO%x\n",data[numbytes]);
//         numbytes++;
//     }
//     Serial.printf("\nnumbytes:%d\n",numbytes);

//     if (numbytes != expectedTransmitSize) {
//         Serial.println("Transmission error; expected bytes does not match recieved bytes.");
//         Serial.print(numbytes);Serial.println(" recieved bytes.");
//         Serial.print(expectedTransmitSize);Serial.println(" expected bytes.");
//     }
// }

void loop()                                                            
{
    how_long("Loop end time (0)");
    Now = millis();
    DataFrame CurrentDataFrame; // Current data frame
    Wire.requestFrom(0x01,292929);
    RequestData(SecondaryTeensyData);
    DecipherData(SecondaryTeensyData);
    // bool suc =MPPTRead();
    if (can2.read(*MPPT_receive_frame))
    {
        CAN_message_t msg=*MPPT_receive_frame;
        Serial.print("CAN2 ");
        Serial.print("MB: "); Serial.print(msg.mb);
        Serial.print("  ID: 0x"); Serial.print(msg.id, HEX);
        if (msg.id==0x614 || msg.id==0x6F4)
        {
            unsigned long bits=(unsigned long)msg.buf[0] + ((unsigned long)msg.buf[1]<<8) + ((unsigned long)msg.buf[2]<<16) + ((unsigned long)msg.buf[3]<<24);
            Serial.printf("Limit: %f",raw_readFloat32(bits));
        }
        Serial.print("  EXT: "); Serial.print(msg.flags.extended);
        Serial.print("  LEN: "); Serial.print(msg.len);
        Serial.print(" DATA: ");
        for ( uint8_t i = 0; i < 8; i++ ) {
            Serial.print(msg.buf[i]); Serial.print(" ");
        }
    }
    Odometer();

    InsertV(&CurrentDataFrame, "N", &iteration);

    InsertV(&CurrentDataFrame, "HallKPH_onepulse", &HallKPH, 1);
    how_long("Hall KPH time");

    InsertV(&CurrentDataFrame, "file", file);

    InsertV(&CurrentDataFrame, "CCV", &CCV,2);

    InsertV(&CurrentDataFrame, "PedV", &PedV,2);

    InsertV(&CurrentDataFrame, "Brake", &BrakeOn);

    InsertV(&CurrentDataFrame, "AnalogBrake", &BrakeIn,2);

    InsertV(&CurrentDataFrame, "CCOn", &CCOn);

    mtr_temp_val = analogRead(mtr_temp_pin);
    InsertV(&CurrentDataFrame, "MotorTemp", &mtr_temp_val);

    mtr_fan_temp_val = (((float)analogRead(mtr_fan_temp_pin)/1023.0)-(498.0/1600.0))*100.0/(502.0/1600.0);                 
    InsertV(&CurrentDataFrame, "MotorFanTemp", &mtr_fan_temp_val);

    InsertV(&CurrentDataFrame, "TripDistance", &trip_distance);
    InsertV(&CurrentDataFrame, "TotalDistance", &total_distance);       

    how_long("Misc (cc, brake, trip) time");

    // GPS
    GPSRead();
    
    InsertV(&CurrentDataFrame, "GPSTime", gps->unix_str);
    InsertV(&CurrentDataFrame, "Lat", &gps->lat, 6);
    InsertV(&CurrentDataFrame, "Lon", &gps->lon, 6);
    InsertV(&CurrentDataFrame, "GPSKph", &gps->kph, 1);

    how_long("GPS time");
    
    // INA
    INARead();

    InsertV(&CurrentDataFrame, "SBatA", &SBat->A, 2); // 12.50
    InsertV(&CurrentDataFrame, "SBatV", &SBat->V, 2);
    InsertV(&CurrentDataFrame, "Mot1A", &Mot1->A, 1); // 8.0
    InsertV(&CurrentDataFrame, "Sol1A", &Sol1->A, 1);
    InsertV(&CurrentDataFrame, "Sol2A", &Sol2->A, 1);
    InsertV(&CurrentDataFrame, "BattV", &Mot1->V, 1); // INA
    float BattA=Sol1->A+Sol2->A-Mot1->A;
    InsertV(&CurrentDataFrame, "BattA", &BattA, 1);
    
    how_long("INA time");

    // DPS
    DPSRead_P();
    DPSRead_T();

    InsertV(&CurrentDataFrame, "Pressure", &dps->Press, 1);
    InsertV(&CurrentDataFrame, "Temperature", &dps->Temp, 1);

    how_long("DPS Time");

    // BMS
    BMSRead();

    InsertV(&CurrentDataFrame, "BMSTime", &bms->Time);
    InsertV(&CurrentDataFrame, "BattCharge", &bms->BattCharge);
    InsertV(&CurrentDataFrame, "BMSBattV", &bms->BattV);
    InsertV(&CurrentDataFrame, "BMSBattA", &bms->BattA);
    InsertV(&CurrentDataFrame, "BMSBattW", &bms->BattW);
    InsertV(&CurrentDataFrame, "HighVNum", &bms->HighVNum);
    InsertV(&CurrentDataFrame, "HighV", &bms->HighV);
    InsertV(&CurrentDataFrame, "AvgV", &bms->AvgV);
    InsertV(&CurrentDataFrame, "LowVNum", &bms->LowVNum);
    InsertV(&CurrentDataFrame, "LowV", &bms->LowV);

    int spread = bms->HighV-bms->LowV;
    InsertV(&CurrentDataFrame, "DCellV", &spread); // spread
    InsertV(&CurrentDataFrame, "MOS_Temp", &bms->MOS_Temp);
    InsertV(&CurrentDataFrame, "TBal", &bms->TBal);
    InsertV(&CurrentDataFrame, "Temp1Neg", &bms->Temp1Neg);
    InsertV(&CurrentDataFrame, "Temp2", &bms->Temp2);
    InsertV(&CurrentDataFrame, "Temp3", &bms->Temp3);
    InsertV(&CurrentDataFrame, "Temp4Pos", &bms->Temp4Pos);
    InsertV(&CurrentDataFrame, "CharMOS", &bms->CharMOS);
    InsertV(&CurrentDataFrame, "DisMOS", &bms->DisMOS);
    InsertV(&CurrentDataFrame, "BalState", &bms->BalState);

    for (unsigned int i=0;i<bms->n_cells;i++)
    {
        char name[7]="";
        sprintf(name, "V%d", i);

        InsertV(&CurrentDataFrame, name, &bms->CellV[i]);
    }

    InsertV(&CurrentDataFrame, "NumCells", &bms->NumCells);
    InsertV(&CurrentDataFrame, "PhysCap", &bms->PhysCap);
    InsertV(&CurrentDataFrame, "RemCap", &bms->RemCap);
    InsertV(&CurrentDataFrame, "CyclCap", &bms->CyclCap);

    how_long("BMS Time");

    int BattV = bms->BattV/10.0;
    int BattP = BattA*BattV;

    InsertV(&CurrentDataFrame, "BattP", &BattP);

    int Sol1P = Sol1->A*BattV;
    int Sol2P = Sol2->A*BattV;

    int SolrP = Sol1P+Sol2P;
    InsertV(&CurrentDataFrame, "SolrP", &SolrP);

    float SolrA = Sol1->A+Sol2->A;
    InsertV(&CurrentDataFrame, "SolrA", &SolrA, 1);

    int Mot1P = Mot1->A*BattV;
    InsertV(&CurrentDataFrame, "Mot1P", &Mot1P);

    how_long("INA calc time");

    InsertV(&CurrentDataFrame, "flag", &flag);
    InsertV(&CurrentDataFrame, "t", &Now);

    how_long("Misc (flag, t) time");

    if (EthernetSuccess && Ethernet.linkStatus() == LinkON)
    {
        if (DatabaseSuccess && mysql_conn.connected())
        {

            ConstructQuery(&CurrentDataFrame, schema, table); // Build a string of all the data, separated by comma.
            // digitalWrite(4, HIGH); // Blue
            memsafe_mysql_execute(&mysql_conn, CurrentDataFrame.query); // Send to the 200 row database

            Log(&Serial,0,"Regular Query: ",CurrentDataFrame.query); 

            ConstructQuery(&CurrentDataFrame, schema, cumulative_table); // Build a string of all the data, separated by comma.
            memsafe_mysql_execute(&mysql_conn, CurrentDataFrame.query);  // Send to the big database

            Log(&Serial,0,"Cumulative Query: ",CurrentDataFrame.query);

            strcpy(CurrentDataFrame.query, ""); // Remove contents of the query string
            sprintf(CurrentDataFrame.query, "DELETE FROM GET23.get31_data WHERE N < %d;", (int)iteration-200);     //Likely will need to change where the data goes                    // Making the string that tells the database to delete rows past N=200
            memsafe_mysql_execute(&mysql_conn, CurrentDataFrame.query); // Send command to database to delete rows past N=200
            // digitalWrite(4, LOW); // Blue

            Log(&Serial,0,"Delete Query: ",CurrentDataFrame.query);
            dat_run = millis();
        } else {
            // dat_run = run_every(30000,dat_run,DatabaseInit);
            Log(&Serial,0,"Labels:",CurrentDataFrame.labels);
            Log(&Serial,0,"Values:",CurrentDataFrame.valueFormat);
            Log(&Serial,0,"Database","not connected.");
        }
        net_run = millis();
    } else {
        // net_run = run_every(30000,net_run,WirelessInit);
        Log(&Serial,0,"Labels:",CurrentDataFrame.labels);
        Log(&Serial,0,"Values:",CurrentDataFrame.valueFormat);
        Log(&Serial,0,"Ethernet","not connected to network.");
    }

    how_long("Database time");

    SDCard_Save(&CurrentDataFrame, &sd_file);
    sd_file.flush();

    odo_run = run_every(30000,odo_run,odometer_write);
    
    Log(&Serial,0,"Loop time: ",millis()-CurrentDataFrame.start);
    Log(&Serial,0,"Iteration:",iteration++);
    // LastDataFrame = CurrentDataFrame;

    how_long("SD time");

    Serial.println("\n\n\n");
    Last = Now;
}
